graph LR

    %% ===== Node Style =====
    classDef base fill:#ffffff,stroke:#475569,stroke-width:1.5px;
    classDef highlight fill:#ffffff,stroke:#0f766e,stroke-width:2px;

    %% ===== Web =====
    subgraph WEB ["WEB UI"]
        A["AD Exposure / Click"]
    end

    %% ===== Automation =====
    subgraph AUTO ["AUTOMATION"]
        B["UI Action Executor"]
        C["Context Collector\nID + Timestamp"]
        B -.-> C
    end

    %% ===== Backend =====
    subgraph BACKEND ["BACKEND"]
        D[("Ad Log Table\nDatabricks")]
    end

    %% ===== Validation =====
    subgraph VAL ["VALIDATION"]
        E["Query Client"]
        F{{"Data Matcher"}}
        G["TestRail Report"]
        E --> F --> G
    end

    %% ===== Flow =====
    A --> B
    B --> D
    C --> F
    D --> E

    %% ===== Subgraph Style =====
    style WEB fill:#f8fafc,stroke:#cbd5f5
    style AUTO fill:#f8fafc,stroke:#cbd5f5
    style BACKEND fill:#f8fafc,stroke:#cbd5f5
    style VAL fill:#f0fdfa,stroke:#0f766e

    %% ===== Apply Classes =====
    class A,B,C,D,E base
    class F,G highlight
